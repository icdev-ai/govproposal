{% extends "base.html" %}
{% block title %}Proposals â€” {{ app_name }}{% endblock %}

{% block content %}
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
    <h1 style="margin:0">Proposals</h1>
    <div style="display:flex;gap:.5rem">
        <span style="padding:.35rem .85rem;border:1px solid #2980b9;border-radius:4px;font-size:.82rem;color:#2980b9;background:#eaf4fb;font-weight:600">
            â˜° List
        </span>
        <a href="{{ url_for('proposals_kanban') }}"
           style="padding:.35rem .85rem;border:1px solid #ddd;border-radius:4px;font-size:.82rem;color:#555;text-decoration:none;background:#fff">
            â¬œ Kanban
        </a>
    </div>
</div>

<!-- Review Stage Legend (compact) -->
<div style="display:flex;flex-wrap:wrap;gap:.4rem .9rem;align-items:center;margin-bottom:.75rem;font-size:.78rem;color:#555">
    <span style="font-weight:600;color:#7f8c8d;text-transform:uppercase;letter-spacing:.04em;font-size:.72rem">Review stages â†’</span>
    <span title="First internal draft review. Checks completeness and major gaps." style="cursor:help;padding:.15rem .5rem;border-radius:3px;background:#fce4ec;color:#ad1457;font-weight:600">ðŸŒ¸ Pink Team</span>
    <span title="Adversarial review â€” a separate team critiques the proposal as if they were the evaluator." style="cursor:help;padding:.15rem .5rem;border-radius:3px;background:#ffebee;color:#c62828;font-weight:600">ðŸ”´ Red Team</span>
    <span title="Senior leadership review. Final approval of strategy, pricing, and win themes." style="cursor:help;padding:.15rem .5rem;border-radius:3px;background:#fff8e1;color:#f57f17;font-weight:600">ðŸ¥‡ Gold Team</span>
    <span title="Final clean-copy quality check before submission." style="cursor:help;padding:.15rem .5rem;border-radius:3px;background:#eceff1;color:#455a64;font-weight:600">ðŸ“‹ White QC</span>
</div>

<section class="card">
    <table class="data-table">
        <thead>
            <tr>
                <th>Title</th>
                <th>Agency</th>
                <th>Due Date</th>
                <th>CAG Status</th>
                <th>Status</th>
                <th>Result</th>
            </tr>
        </thead>
        <tbody>
            {% for p in proposals %}
            <tr>
                <td><a href="{{ url_for('proposal_detail', prop_id=p['id']) }}">{{ p['title'][:55] }}{% if p['title']|length > 55 %}...{% endif %}</a></td>
                <td>{{ p['agency'][:25] if p['agency'] else 'â€”' }}</td>
                <td>{{ p['due_date'][:10] if p['due_date'] else 'â€”' }}</td>
                <td><span class="cag-status cag-{{ p['cag_status'] }}">{{ p['cag_status']|upper if p['cag_status'] else 'PENDING' }}</span></td>
                <td><span class="badge badge-{{ p['status'] }}">{{ p['status']|replace('_',' ') }}</span></td>
                <td>{% if p['result'] %}<span class="badge badge-{{ p['result'] }}">{{ p['result']|upper }}</span>{% else %}â€”{% endif %}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% if not proposals %}
    <div class="empty-state" style="padding:2.5rem 1rem;text-align:center">
        <p style="margin-bottom:1rem;color:#7f8c8d">No proposals created yet.</p>
        <a href="{{ url_for('opportunities') }}"
           style="padding:.5rem 1.2rem;background:#0984e3;color:#fff;border-radius:5px;text-decoration:none;font-weight:600;font-size:.88rem">
            Browse Opportunities to Start a Proposal
        </a>
    </div>
    {% endif %}
</section>
{% endblock %}
